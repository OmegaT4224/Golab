<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quantum Blockchain Demo - Standalone</title>
    <style>
        body { 
            margin: 0; 
            padding: 20px;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background: linear-gradient(135deg, #0f0f0f, #1a1a2e, #16213e);
            color: white;
            min-height: 100vh;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        .header h1 {
            color: #4fc3f7;
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        .header p {
            color: #b0bec5;
            font-size: 1.1rem;
        }
        .demo-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        .panel {
            background: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(79, 195, 247, 0.3);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }
        .panel h2 {
            color: #4fc3f7;
            margin-top: 0;
            font-size: 1.3rem;
        }
        .status {
            background: rgba(79, 195, 247, 0.1);
            border: 1px solid #4fc3f7;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: center;
            font-weight: 500;
        }
        .blockchain-info {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }
        .block {
            background: linear-gradient(135deg, rgba(76, 175, 80, 0.2), rgba(76, 175, 80, 0.1));
            border: 1px solid #4caf50;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .block:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(76, 175, 80, 0.3);
        }
        .block.genesis {
            background: linear-gradient(135deg, rgba(255, 193, 7, 0.2), rgba(255, 193, 7, 0.1));
            border-color: #ffc107;
        }
        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
        button {
            background: linear-gradient(135deg, #4fc3f7, #29b6f6);
            border: none;
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            font-size: 14px;
        }
        button:hover {
            background: linear-gradient(135deg, #29b6f6, #0288d1);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(79, 195, 247, 0.4);
        }
        button:disabled {
            background: #555;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        input {
            padding: 12px;
            border: 1px solid rgba(79, 195, 247, 0.5);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 14px;
            flex: 1;
            min-width: 200px;
        }
        input:focus {
            outline: none;
            border-color: #4fc3f7;
            box-shadow: 0 0 0 2px rgba(79, 195, 247, 0.3);
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        .stat-item {
            text-align: center;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #4fc3f7;
            display: block;
        }
        .stat-label {
            font-size: 0.9rem;
            color: #b0bec5;
            margin-top: 5px;
        }
        .quantum-effect {
            animation: quantumPulse 2s ease-in-out infinite;
        }
        @keyframes quantumPulse {
            0%, 100% { opacity: 0.8; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.02); }
        }
        .mining-indicator {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(79, 195, 247, 0.3);
            border-radius: 50%;
            border-top-color: #4fc3f7;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        .blockchain-visual {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 20px;
            max-height: 500px;
            overflow-y: auto;
        }
        @media (max-width: 768px) {
            .demo-grid {
                grid-template-columns: 1fr;
            }
            .controls {
                flex-direction: column;
            }
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üöÄ Quantum Blockchain Laboratory</h1>
            <p>Experience quantum-resistant blockchain technology with 3-qubit circuit-inspired signatures</p>
        </div>
        
        <div class="status quantum-effect" id="status">
            <span class="mining-indicator"></span>Initializing quantum blockchain...
        </div>

        <div class="demo-grid">
            <div class="panel">
                <h2>üìä Blockchain Statistics</h2>
                <div class="stats-grid" id="stats-grid">
                    <div class="stat-item">
                        <span class="stat-value" id="block-count">0</span>
                        <div class="stat-label">Total Blocks</div>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="difficulty-value">2</span>
                        <div class="stat-label">Mining Difficulty</div>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="chain-status">‚Äî</span>
                        <div class="stat-label">Chain Status</div>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="last-block-time">‚Äî</span>
                        <div class="stat-label">Last Block</div>
                    </div>
                </div>
            </div>

            <div class="panel">
                <h2>‚õèÔ∏è Mining Controls</h2>
                <div class="controls">
                    <input type="text" id="blockData" placeholder="Enter transaction data (e.g., 'Alice sends 10 QTC to Bob')" />
                    <button onclick="addBlock()" id="mine-btn">Mine Block</button>
                </div>
                <div class="controls">
                    <button onclick="runDemo()">üé¨ Demo Transactions</button>
                    <button onclick="validateChain()">‚úÖ Validate Chain</button>
                    <button onclick="adjustDifficulty()">‚öôÔ∏è Adjust Difficulty</button>
                </div>
            </div>
        </div>

        <div class="panel">
            <h2>üîó Blockchain Visualization</h2>
            <div class="blockchain-visual" id="blocks">
                <div style="text-align: center; color: #666; padding: 40px;">
                    Blockchain will appear here once initialized...
                </div>
            </div>
        </div>
    </div>

    <!-- Include blockchain modules -->
    <script src="blockchain.js"></script>

    <script>
        let blockchain;
        let isInitialized = false;

        function initializeBlockchain() {
            try {
                console.log('üöÄ Initializing quantum blockchain...');
                updateStatus('‚ö° Creating genesis block...');
                
                blockchain = new Blockchain();
                
                // Add initial demo block
                updateStatus('üîß Adding initial transaction...');
                blockchain.addBlock({
                    type: 'genesis_transaction',
                    data: 'Initial quantum coin distribution - 1000 QTC minted',
                    timestamp: Date.now()
                });

                updateStatus('‚úÖ Quantum blockchain ready! Start mining blocks or run the demo.');
                isInitialized = true;
                updateDisplay();
                
            } catch (error) {
                console.error('‚ùå Blockchain initialization error:', error);
                updateStatus('‚ùå Error: ' + error.message);
            }
        }

        function updateStatus(message) {
            const statusEl = document.getElementById('status');
            if (message.includes('‚ùå')) {
                statusEl.style.background = 'rgba(244, 67, 54, 0.2)';
                statusEl.style.borderColor = '#f44336';
            } else if (message.includes('‚úÖ')) {
                statusEl.style.background = 'rgba(76, 175, 80, 0.2)';
                statusEl.style.borderColor = '#4caf50';
            } else {
                statusEl.style.background = 'rgba(79, 195, 247, 0.2)';
                statusEl.style.borderColor = '#4fc3f7';
            }
            statusEl.innerHTML = message;
        }

        function updateDisplay() {
            if (!blockchain || !isInitialized) return;

            const stats = blockchain.getStats();
            
            // Update statistics
            document.getElementById('block-count').textContent = stats.totalBlocks;
            document.getElementById('difficulty-value').textContent = stats.difficulty;
            
            const statusEl = document.getElementById('chain-status');
            statusEl.textContent = stats.isValid ? '‚úÖ Valid' : '‚ùå Invalid';
            statusEl.style.color = stats.isValid ? '#4caf50' : '#f44336';
            
            const timeEl = document.getElementById('last-block-time');
            const timeAgo = Math.floor((Date.now() - stats.lastBlockTime) / 1000);
            timeEl.textContent = timeAgo < 60 ? `${timeAgo}s ago` : `${Math.floor(timeAgo/60)}m ago`;

            // Display blocks
            const blocksDiv = document.getElementById('blocks');
            blocksDiv.innerHTML = '';
            
            blockchain.chain.forEach((block, index) => {
                const blockDiv = document.createElement('div');
                blockDiv.className = `block ${index === 0 ? 'genesis' : ''}`;
                blockDiv.onclick = () => showBlockDetails(block);
                
                const isGenesis = index === 0;
                const icon = isGenesis ? 'üåü' : 'üì¶';
                const title = isGenesis ? 'Genesis Block' : `Block #${block.index}`;
                
                blockDiv.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <strong>${icon} ${title}</strong>
                        <span style="color: #4fc3f7; font-size: 0.9em;">${new Date(block.timestamp).toLocaleTimeString()}</span>
                    </div>
                    <div style="margin-bottom: 8px;"><strong>Hash:</strong> ${block.hash}</div>
                    <div style="margin-bottom: 8px;"><strong>Previous:</strong> ${block.previousHash}</div>
                    <div style="margin-bottom: 8px;"><strong>Data:</strong> ${typeof block.data === 'string' ? block.data : JSON.stringify(block.data)}</div>
                    <div style="margin-bottom: 8px;"><strong>Nonce:</strong> ${block.nonce}</div>
                    <div><strong>Quantum Signature:</strong> ${block.quantumSignature.substring(0, 40)}...</div>
                `;
                blocksDiv.appendChild(blockDiv);
            });
        }

        function showBlockDetails(block) {
            const details = `
üì¶ Block Details

üÜî Index: ${block.index}
üîó Hash: ${block.hash}
‚õìÔ∏è Previous Hash: ${block.previousHash}
üìÖ Timestamp: ${new Date(block.timestamp).toLocaleString()}
üé≤ Nonce: ${block.nonce}
üìä Data: ${typeof block.data === 'string' ? block.data : JSON.stringify(block.data, null, 2)}
üîê Quantum Signature: ${block.quantumSignature}
‚úÖ Valid: ${block.isValid() ? 'Yes' : 'No'}
            `;
            alert(details);
        }

        function addBlock() {
            const dataInput = document.getElementById('blockData');
            const data = dataInput.value.trim();
            
            if (!data) {
                alert('Please enter transaction data');
                return;
            }

            if (!blockchain || !isInitialized) {
                alert('Blockchain not initialized');
                return;
            }

            const mineBtn = document.getElementById('mine-btn');
            mineBtn.disabled = true;
            mineBtn.textContent = '‚õèÔ∏è Mining...';
            updateStatus('‚õèÔ∏è Mining new block... This may take a moment.');
            
            // Use setTimeout to prevent UI blocking
            setTimeout(() => {
                try {
                    const startTime = Date.now();
                    blockchain.addBlock({
                        type: 'user-transaction',
                        data: data,
                        timestamp: Date.now(),
                        user: 'demo-user'
                    });
                    
                    const miningTime = Date.now() - startTime;
                    dataInput.value = '';
                    updateStatus(`‚úÖ Block mined successfully in ${miningTime}ms! üéâ`);
                    updateDisplay();
                } catch (error) {
                    updateStatus('‚ùå Error mining block: ' + error.message);
                } finally {
                    mineBtn.disabled = false;
                    mineBtn.textContent = 'Mine Block';
                }
            }, 100);
        }

        function runDemo() {
            if (!blockchain || !isInitialized) {
                alert('Blockchain not initialized');
                return;
            }

            const demoData = [
                'Alice creates quantum wallet with 100 QTC',
                'Bob receives 25 QTC from Alice',
                'Charlie trades 15 QTC for quantum computing time', 
                'Dave stakes 30 QTC in quantum mining pool',
                'Eve sends 5 QTC to quantum research fund'
            ];

            updateStatus('üé¨ Running quantum demo transactions...');
            let index = 0;
            
            function addDemoBlock() {
                if (index < demoData.length) {
                    updateStatus(`üé¨ Demo ${index + 1}/${demoData.length}: ${demoData[index]}`);
                    blockchain.addBlock({
                        type: 'demo-transaction',
                        data: demoData[index],
                        timestamp: Date.now(),
                        demo: true
                    });
                    
                    updateDisplay();
                    index++;
                    setTimeout(addDemoBlock, 1500);
                } else {
                    updateStatus('‚úÖ Demo completed! 5 quantum transactions added to the blockchain.');
                }
            }
            
            addDemoBlock();
        }

        function validateChain() {
            if (!blockchain || !isInitialized) {
                alert('Blockchain not initialized');
                return;
            }

            updateStatus('üîç Validating blockchain integrity...');
            
            setTimeout(() => {
                const isValid = blockchain.isChainValid();
                const message = isValid ? 
                    '‚úÖ Blockchain validation successful! All blocks are valid and properly linked.' : 
                    '‚ùå Blockchain validation failed! Chain integrity compromised.';
                updateStatus(message);
                updateDisplay();
            }, 1000);
        }

        function adjustDifficulty() {
            if (!blockchain || !isInitialized) {
                alert('Blockchain not initialized');
                return;
            }

            const current = blockchain.difficulty;
            const newDifficulty = prompt(`Current difficulty: ${current}\nEnter new difficulty (1-6):`, current);
            
            if (newDifficulty !== null && !isNaN(newDifficulty)) {
                const difficulty = parseInt(newDifficulty);
                if (difficulty >= 1 && difficulty <= 6) {
                    blockchain.setDifficulty(difficulty);
                    updateStatus(`‚öôÔ∏è Mining difficulty adjusted to level ${difficulty}`);
                    updateDisplay();
                } else {
                    alert('Difficulty must be between 1 and 6');
                }
            }
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            updateStatus('üîß Loading quantum blockchain modules...');
            setTimeout(initializeBlockchain, 1000);
        });

        // Handle Enter key in input
        document.getElementById('blockData').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                addBlock();
            }
        });

        // Auto-update display every 30 seconds
        setInterval(() => {
            if (isInitialized) {
                updateDisplay();
            }
        }, 30000);

        console.log('üöÄ Quantum Blockchain Lab loaded!');
        console.log('üí° Try the demo transactions or create your own blocks');
    </script>
</body>
</html>